<div class="container">
    <h1 class="mt-3">{{title()}}</h1>

    @if(isLoading() || isSaving()){
        <mat-spinner></mat-spinner>
    }

    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="m-4">
        <div class="mb-3">
            <label for="title" class="form-label fw-semibold">Title</label>
            <input type="text" class="form-control" formControlName="title">
        </div>
        <div class="mb-3">
            <label for="shortDescription" class="form-label fw-semibold">Short Description</label>
            <input type="text" class="form-control" formControlName="shortDescription">
        </div>
        <div class="mb-3">
            <label for="urlHandle" class="form-label fw-semibold">Url Handle</label>
            <input type="text" class="form-control" formControlName="urlHandle">
        </div>
        <div class="mb-3">
            <div class="d-flex flex-row">
                <div class="col-6 p-2">
                    <label for="content" class="form-label fw-semibold">Content</label>
                    <textarea class="form-control" formControlName="content" rows="5"></textarea>
                </div>
                <div class="col-6 p-2" style="max-height: 350px; overflow-y: scroll;">
                    <markdown [data]="form.controls['content'].getRawValue()"></markdown>
                </div>
            </div>
        </div>
        <div class="mb-3">
            <label for="featuredImageUrl" class="form-label fw-semibold">Featured Image Url</label>
            @if(form.controls['featuredImageUrl'].getRawValue()){
                <div>
                    <img style="width: 100px;" class="my-2"
                     [src]="form.controls['featuredImageUrl'].getRawValue()" />
                </div>
            }
            <input type="text" class="form-control" formControlName="featuredImageUrl">
        </div>
        <div class="mb-3">
            <label for="author" class="form-label fw-semibold">Author</label>
            <input type="text" class="form-control" formControlName="author">
        </div>
        <div class="mb-3">
            <label for="publishedDate" class="form-label fw-semibold">Published Date</label>
            <input type="date" class="form-control" formControlName="publishedDate">
        </div>
        <div class="mb-3">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="isVisible" formControlName="isVisible"> 
                <label class="form-check-label" for="isVisible">
                    Is Visible?
                </label>
            </div>
        </div>
        <div class="mb-3">
            <label for="categories" class="form-label fw-semibold">Categories</label>
            <select class="form-control" multiple formControlName="categories">
                @for(cat of categories(); track cat.id){
                    <option [value]="cat.id">{{cat.name}}</option>
                }
            </select>
        </div>
        <div class="d-flex justify-content-end mb-4">
            <button class="btn btn-primary me-2" type="submit">Save</button>
            <button *ngIf="blogPostId()" class="btn btn-danger" (click)="onDelete()">Delete</button>
        </div>
    </form>
</div>      